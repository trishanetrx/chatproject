<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>GTM Public Chat</title>

    <!-- Redirect if not logged in -->
    <script>
        if (!localStorage.getItem("username")) {
            window.location.href = "login.html";
        }
    </script>

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Tailwind config (REQUIRED for dark mode) -->
    <script>
        tailwind.config = {
            darkMode: "class",
        };
    </script>

    <!-- Icons & Fonts -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet"/>

    <!-- Socket.io -->
    <script src="https://chatapi.copythingz.shop/socket.io/socket.io.js"></script>

    <!-- Emoji Picker -->
    <script src="https://unpkg.com/emoji-mart@latest/dist/browser.js"></script>

    <style>
        body {
            overflow: hidden;
        }

        /* SIDEBAR MOBILE ANIMATION */
        #sidebar {
            transition: left 0.3s ease;
        }

        #sidebar.open {
            left: 0;
        }

        /* Chat bubbles */
        .bubble-me-light { background-color: #DCF8C6; color: #111; }
        .bubble-me-dark { background-color: #25D366; color: #000; }
        .bubble-other-light { background-color: #fff; color: #111; }
        .bubble-other-dark { background-color: #1F1F1F; color: #fff; }
    </style>
</head>

<body class="bg-[#ECE5DD] dark:bg-black text-black dark:text-white">

<!-- HEADER (WhatsApp style) -->
<header class="fixed top-0 left-0 w-full h-[60px] bg-white dark:bg-black border-b border-gray-300 dark:border-[#222] z-[1000] 
flex items-center justify-between px-3">

    <button id="mobileMenuBtn" class="text-3xl font-bold lg:hidden text-black dark:text-white">
        â˜°
    </button>

    <h1 class="font-semibold text-lg text-black dark:text-white">GTM Public Chat</h1>

    <button id="themeToggle" class="text-xl px-3 py-1 dark:text-white">
        ðŸŒ™
    </button>

    <button id="logoutButton" class="px-3 py-1 bg-red-500 text-white rounded">
        Logout
    </button>
</header>

<!-- MAIN CONTAINER -->
<main class="absolute top-[60px] left-0 right-0 bottom-0 flex overflow-hidden">

    <!-- SIDEBAR -->
    <aside
        id="sidebar"
        class="w-[260px] bg-white dark:bg-black border-r border-gray-300 dark:border-[#222]
        p-3 hidden lg:flex flex-col overflow-hidden lg:static fixed top-[60px] left-[-260px] h-[calc(100%-60px)] z-[1500]">

        <h2 class="font-bold mb-3 text-black dark:text-white">Online Users</h2>

        <ul id="userList" class="flex-1 overflow-y-auto space-y-2 pr-1"></ul>

        <div id="loggedInUser"
             class="mt-3 text-center bg-gray-100 dark:bg-[#111] p-2 rounded text-sm text-gray-700 dark:text-gray-300">
        </div>
    </aside>

    <!-- OVERLAY (mobile only) -->
    <div id="overlay" class="hidden fixed top-[60px] left-0 right-0 bottom-0 bg-black/50 z-[1400]"></div>

    <!-- CHAT SECTION -->
    <section class="flex-1 flex flex-col bg-[#ECE5DD] dark:bg-black">

        <!-- MESSAGES -->
        <div id="messages" class="flex-1 overflow-y-auto p-4 space-y-3"></div>

        <!-- INPUT BAR -->
        <form id="messageForm" class="p-3 flex gap-2 items-center bg-white dark:bg-black border-t border-gray-300 dark:border-[#222]">

            <button type="button" id="emojiButton" class="text-2xl">ðŸ˜Š</button>

            <input
                id="messageInput"
                class="flex-1 bg-white dark:bg-[#111] text-black dark:text-white p-2 rounded border border-gray-300 dark:border-[#333]"
                placeholder="Type a message..."
                autocomplete="off"
                required
            />

            <button type="submit" class="px-4 py-2 bg-green-500 text-white rounded">
                Send
            </button>

            <div id="emojiPicker" class="absolute bottom-[70px] left-3 z-[2000] hidden"></div>
        </form>
    </section>

</main>

<script src="chat.js"></script>

</body>
</html>
